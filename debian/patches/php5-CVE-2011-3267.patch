Subject: Fixed crash in error_log() (strlen(NULL))
Origin: http://svn.php.net/viewvc?view=revision&revision=312417

r312417 | felipe | 2011-06-23 14:48:15 -0700 (Thu, 23 Jun 2011) | 1 line
- Fixed crash in error_log() (strlen(NULL)) reported by: shm, Maksymilian Arciemowicz

CVE-2011-3267

---
 ext/standard/basic_functions.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/ext/standard/basic_functions.c
+++ b/ext/standard/basic_functions.c
@@ -4671,7 +4671,7 @@ PHP_FUNCTION(error_log)
 		opt_err = erropt;
 	}
 
-	if (opt_err == 3) {
+	if (opt_err == 3 && opt) {
 		if (strlen(opt) != opt_len) {
 			RETURN_FALSE;
 		}
