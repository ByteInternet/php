--- old/ext/openssl/openssl.c	2007/07/11 12:18:14	1.98.2.5.2.38
+++ new/ext/openssl/openssl.c	2007/08/08 06:29:46	1.98.2.5.2.41
@@ -1726,7 +1726,7 @@
 		/* Finally apply defaults from config file */
 		for(i = 0; i < sk_CONF_VALUE_num(dn_sk); i++) {
 			int len;
-			char buffer[200];
+			char buffer[200 + 1]; /*200 + \0 !*/
 			
 			v = sk_CONF_VALUE_value(dn_sk, i);
 			type = v->name;
@@ -1739,7 +1739,9 @@
 			if (strcmp("_default", type + len) != 0) {
 				continue;
 			}
-			
+			if (len > 200) {
+				len = 200;
+			}
 			memcpy(buffer, type, len);
 			buffer[len] = '\0';
 			type = buffer;
