fix for CVE-2008-3659
http://cvs.php.net/viewvc.cgi/ZendEngine2/zend_operators.h?r1=1.94.2.4.2.11&r2=1.94.2.4.2.12&view=patch
--- a/Zend/zend_operators.h
+++ b/Zend/zend_operators.h
@@ -220,6 +220,9 @@ zend_memnstr(char *haystack, char *needl
 	char *p = haystack;
 	char ne = needle[needle_len-1];
 
+	if(needle_len > end-haystack) {
+		return NULL;
+	}
 	end -= needle_len;
 
 	while (p <= end) {
