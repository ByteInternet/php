From: Xinchen Hui <laruence@php.net>
Date: Thu, 8 Jan 2015 16:09:02 +0800
Subject: Fixed bug #68740 (Null pointer deference in ext/ereg/regex/regcomp.c)

---
 ext/ereg/regex/regcomp.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/ext/ereg/regex/regcomp.c b/ext/ereg/regex/regcomp.c
index f4bfc1c..c2223d7 100644
--- a/ext/ereg/regex/regcomp.c
+++ b/ext/ereg/regex/regcomp.c
@@ -1284,6 +1284,10 @@ int c;
 	register int ncols = (g->ncsets+(CHAR_BIT-1)) / CHAR_BIT;
 	register unsigned uc = (unsigned char)c;
 
+	if (!g->setbits) {
+		return(0);
+	}
+
 	for (i = 0, col = g->setbits; i < ncols; i++, col += g->csetsize)
 		if (col[uc] != 0)
 			return(1);
